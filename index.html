<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Comparateur de prix des matériaux de construction au Maroc. Comparez le béton, l'acier, le ciment et plus encore.">
    <title>BinaaCompare | Le 1er Comparateur BTP au Maroc</title>
    
    <link rel="stylesheet" href="style.css">
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

</head>
<body>

    <nav class="navbar">
    <div class="container">
        <a href="index.html" class="logo">Binaa<span>Compare</span></a>
        
        <div class="menu-toggle" id="mobile-menu">
            <i class="fa-solid fa-bars"></i>
        </div>

        <ul class="nav-links" id="nav-list">
            <li><a href="index.html">Accueil</a></li>
            <li><a href="materiaux.html">Matériaux</a></li>
            <li><a href="f.html">Fournisseurs</a></li>
            <li><a href="avis.html">Avis</a></li>
            
            <li class="mobile-only auth-guest"><a href="cnx cendeur.html"><i class="fa-solid fa-shop"></i> Espace Vendeur</a></li>
            <li class="mobile-only auth-guest"><a href="conx.html"><i class="fa-solid fa-user-tag"></i> Espace Acheteur</a></li>
            
            <li id="dynamicProfileLink" class="mobile-only auth-logged" style="display: none;">
    <a href="#" id="profileAnchor" style="display: flex; align-items: center; gap: 8px; text-decoration: none; color: inherit;">
        <i class="fa-solid fa-circle-user"></i> 
        <span id="profileText">Mon Profil</span>
    </a>
</li>

<script type="module">
    // 1. Importations Firebase
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // 2. Votre Configuration (Vérifiez qu'elle correspond à votre projet)
    const firebaseConfig = {
        apiKey: "AIzaSyB6WrsIzfsCCHMZmBkPzLQK2csKveaxY4U",
        authDomain: "binaacompare-fa5e1.firebaseapp.com",
        projectId: "binaacompare-fa5e1",
        storageBucket: "binaacompare-fa5e1.firebasestorage.app",
        messagingSenderId: "667570543544",
        appId: "1:667570543544:web:652218ab5a773eb2154d4d"
    };

    // 3. Initialisation
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // 4. Logique de redirection
    const profileLi = document.getElementById('dynamicProfileLink');
    const profileAnchor = document.getElementById('profileAnchor');
    const profileText = document.getElementById('profileText');

    onAuthStateChanged(auth, async (user) => {
        if (user) {
            try {
                // On va chercher le document de l'utilisateur dans la collection "users"
                const userRef = doc(db, "users", user.uid);
                const userSnap = await getDoc(userRef);

                if (userSnap.exists()) {
                    const userData = userSnap.data();
                    profileLi.style.display = "block"; // On affiche le bouton

                    // Vérification du rôle
                    if (userData.role === "vendor") {
                        profileAnchor.href = "dachv.html"; // Lien Vendeur
                        profileText.innerText = "Dashboard Vendeur";
                    } else {
                        profileAnchor.href = "dasha.html"; // Lien Acheteur
                        profileText.innerText = "Espace Client";
                    }
                } else {
                    console.log("Utilisateur connecté mais aucun document trouvé dans Firestore.");
                }
            } catch (error) {
                console.error("Erreur lors de la récupération du profil:", error);
            }
        } else {
            // Si pas de session active, on cache le lien
            profileLi.style.display = "none";
        }
    });
</script>
            <li class="mobile-only auth-logged" style="display: none;"><a href="#" class="logout-action" style="color: #e67e22;"><i class="fa-solid fa-power-off"></i> Déconnexion</a></li>
        </ul>

        
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyB6WrsIzfsCCHMZmBkPzLQK2csKveaxY4U",
            authDomain: "binaacompare-fa5e1.firebaseapp.com",
            projectId: "binaacompare-fa5e1",
            storageBucket: "binaacompare-fa5e1.firebasestorage.app",
            messagingSenderId: "667570543544",
            appId: "1:667570543544:web:652218ab5a773eb2154d4d"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // --- MENU MOBILE ---
        const menuToggle = document.getElementById('mobile-menu');
        const navList = document.getElementById('nav-list');
        menuToggle.onclick = () => {
            navList.classList.toggle('active');
            menuToggle.querySelector('i').classList.toggle('fa-bars');
            menuToggle.querySelector('i').classList.toggle('fa-xmark');
        };

        // --- GESTION DES ETATS (CONNECTÉ / DÉCONNECTÉ) ---
        const guestElements = document.querySelectorAll('.auth-guest');
        const loggedElements = document.querySelectorAll('.auth-logged');

        onAuthStateChanged(auth, (user) => {
            if (user) {
                // Masquer boutons visiteurs, afficher profil
                guestElements.forEach(el => el.style.setProperty('display', 'none', 'important'));
                loggedElements.forEach(el => {
                    el.style.display = (el.tagName === 'LI') ? 'block' : 'flex';
                });
            } else {
                // Masquer profil, afficher boutons visiteurs
                guestElements.forEach(el => {
                    el.style.display = (el.tagName === 'LI') ? 'block' : 'flex';
                });
                loggedElements.forEach(el => el.style.setProperty('display', 'none', 'important'));
            }
        });

        // --- LOGIQUE DE DÉCONNEXION ---
        const logoutActions = document.querySelectorAll('.logout-action');
        logoutActions.forEach(btn => {
            btn.onclick = (e) => {
                e.preventDefault();
                signOut(auth).then(() => {
                    window.location.href = "index.html";
                });
            };
        });
    </script>
</nav>

    <header class="hero-section">
    <div class="container">
        <h1>Comparez les prix des matériaux de construction au Maroc</h1>
        
        <div class="search-box">
            <div class="input-group">
                <i class="fa-solid fa-magnifying-glass"></i>
                <input type="text" id="searchInput" placeholder="Que cherchez-vous ? (ex: Ciment, Acier...)">
            </div>
            <div class="input-group">
                <i class="fa-solid fa-location-dot"></i>
                <input type="text" id="cityInput" placeholder="Ville (ex: Casablanca)">
            </div>
            <button class="btn-search" id="btnSearch">Comparer</button>
        </div>
    </div>
</header>

<script>
    // استخدام id="btnSearch" لضمان عمل الزر
    document.getElementById('btnSearch').addEventListener('click', () => {
        const keyword = document.getElementById('searchInput').value.trim();
        const city = document.getElementById('cityInput').value.trim();
        
        // إرسال المستخدم إلى صفحة materiaux.html مع الكلمات البحثية في الرابط (URL)
        // إذا تركت الخانات فارغة، سيعرض كل المنتجات
        window.location.href = `repro.html?search=${encodeURIComponent(keyword)}&city=${encodeURIComponent(city)}`;
    });

    // للسماح للمستخدم بالضغط على Enter للبحث
    document.getElementById('searchInput').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') document.getElementById('btnSearch').click();
    });
</script>

    <section class="categories section-padding">
        <div class="container">
            <h2 class="section-title">Matériaux les plus recherchés</h2>
            <div class="grid-container">
                <div class="category-card">
                    <i class="fa-solid fa-trowel-bricks icon"></i>
                    <h3>Ciment & Béton</h3>
                    <p>CPJ 35, CPJ 45, Béton prêt...</p>
                </div>
                <div class="category-card">
                    <i class="fa-solid fa-layer-group icon"></i>
                    <h3>Aciers & Armatures</h3>
                    <p>Ronds à béton, Treillis...</p>
                </div>
                <div class="category-card">
                    <i class="fa-solid fa-cubes-stacked icon"></i>
                    <h3>Briques & Parpaings</h3>
                    <p>Briques rouges, Hourdis...</p>
                </div>
                <div class="category-card">
                    <i class="fa-solid fa-paint-roller icon"></i>
                    <h3>Finition & Peinture</h3>
                    <p>Carrelage, Peintures, Enduits...</p>
                </div>
            </div>
        </div>
    </section>

    <section class="features section-padding bg-light">
        <div class="container">
            <h2 class="section-title">Pourquoi utiliser BinaaCompare ?</h2>
            <div class="features-grid">
                <div class="feature-item">
                    <i class="fa-solid fa-hand-holding-dollar"></i>
                    <h3>Meilleurs Prix</h3>
                    <p>Économisez jusqu'à 20% sur vos chantiers en comparant les fournisseurs locaux.</p>
                </div>
                <div class="feature-item">
                    <i class="fa-solid fa-stopwatch"></i>
                    <h3>Gain de Temps</h3>
                    <p>Plus besoin d'appeler 10 fournisseurs. Obtenez des devis instantanés.</p>
                </div>
                <div class="feature-item">
                    <i class="fa-solid fa-certificate"></i>
                    <h3>Fournisseurs Vérifiés</h3>
                    <p>Nous ne listons que des fournisseurs fiables respectant les normes marocaines.</p>
                </div>
            </div>
        </div>
    </section>

    <section class="supplier-cta">
        <div class="container">
            <h2>Vous êtes fournisseur de matériaux ?</h2>
            <p>Rejoignez le premier réseau digital du BTP au Maroc et augmentez vos ventes.</p>
            <a href="#" class="btn btn-outline-white">Devenir Partenaire</a>
        </div>
    </section>

    <footer>
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <h3>BinaaCompare</h3>
                    <p>La plateforme de référence pour les professionnels et particuliers du bâtiment au Maroc.</p>
                </div>
                <div class="footer-col">
                    <h4>Liens Rapides</h4>
                    <ul>
                        <li><a href="#">Qui sommes-nous</a></li>
                        <li><a href="#">Blog Construction</a></li>
                        <li><a href="#">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Support</h4>
                    <ul>
                        <li><a href="#">FAQ</a></li>
                        <li><a href="#">Conditions Générales</a></li>
                        <li><a href="#">Politique de Confidentialité</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Contactez-nous</h4>
                    <p><i class="fa-solid fa-envelope"></i> contact@binaacompare.ma</p>
                    <p><i class="fa-solid fa-phone"></i> +212 5 22 00 00 00</p>
                    <div class="social-icons">
                        <a href="#"><i class="fa-brands fa-linkedin"></i></a>
                        <a href="#"><i class="fa-brands fa-facebook"></i></a>
                        <a href="#"><i class="fa-brands fa-instagram"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 BinaaCompare. Tous droits réservés. Fait avec passion au Maroc.</p>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
    


</body>
</html>